#!/bin/bash
set -e

# ðŸ”’ Ensure script is run as root
if [ "$EUID" -ne 0 ]; then
  echo "âŒ Please run as root"
  exit 1
fi

# ðŸ” Step 1: Check if curl is installed
if ! command -v curl >/dev/null 2>&1; then
  echo "ðŸ“¦ curl not found. Installing curl..."
  if command -v dnf >/dev/null 2>&1; then
    dnf install -y curl
  else
    echo "âš ï¸ Unsupported package manager. Install curl manually."
    exit 1
  fi
else
  echo "âœ… curl is already installed."
fi

# â¬‡ï¸ Step 2: Download dysk to /usr/local/bin
echo "ðŸ“¥ Downloading dysk..."
curl -o /usr/local/bin/dysk https://dystroy.org/dysk/download/x86_64-linux/dysk

# ðŸ› ï¸ Step 3: Make dysk executable
chmod +x /usr/local/bin/dysk

# ðŸ§¹ Step 4: Clean up
rm -f dysk 2>/dev/null || true  # Only if some stray local file exists

echo "âœ… Installation complete. You can now use 'dysk'."
